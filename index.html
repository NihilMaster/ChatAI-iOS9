// En tu frontend, cambia la función sendMessage por esta versión:
function sendMessage() {
    var message = messageInput.value.trim();
    if (!message) return;
    
    showMessage(message, 'user');
    messageInput.value = '';
    sendButton.disabled = true;
    
    console.log('📤 Enviando mensaje al backend...');
    
    var xhr = new XMLHttpRequest();
    var url = config.backendUrl + '/chat';
    console.log('🔗 URL:', url);
    
    xhr.open('POST', url, true);
    xhr.setRequestHeader('Content-Type', 'application/json');
    
    xhr.onreadystatechange = function() {
        console.log('📥 Estado XHR:', xhr.readyState, 'Status:', xhr.status);
        
        if (xhr.readyState === 4) {
            sendButton.disabled = false;
            
            if (xhr.status === 200) {
                console.log('✅ Respuesta recibida:', xhr.responseText);
                try {
                    var response = JSON.parse(xhr.responseText);
                    if (response.success) {
                        showMessage(response.message, 'bot');
                    } else {
                        showError('Error: ' + response.error);
                    }
                } catch (e) {
                    showError('Error parseando JSON: ' + e.message);
                }
            } else {
                showError('HTTP Error: ' + xhr.status);
            }
        }
    };
    
    xhr.onerror = function() {
        console.error('❌ Error de red');
        sendButton.disabled = false;
        showError('Error de red');
    };
    
    var requestData = {
        message: message,
        apiKey: config.apiKey
    };
    
    console.log('📦 Enviando datos:', requestData);
    xhr.send(JSON.stringify(requestData));
}